---
created: 2022-06-19
tags: 计算组 字符格式化 
subject: 案例
importance: 4
skilled: 4
status:
author: sql
url: https://www.wolai.com/muxiaoqi/pHaxpENdRo3yU5F9WR65fP
cover: 
---
https://www.sqlbi.com/articles/controlling-format-strings-in-calculation-groups/


![](https://secure2.wostatic.cn/static/abUgKxjERqaSaw9uaP853o/image.png?auth_key=1655612671-jS1EjeQdHwfgHGKQoQ4G3C-0-8ad01b7234800f7365fb9c3a80d8502c)

控制图表显示格式

```js
IF( ISSELECTEDMEASURE( [KPI.Value&Ratio] ),

    

    "0.0" & " / " & UNICHAR( 34 ) & "G " & 
    FORMAT( [KPI.G%] , "0.0%" ) & " / " & "M " & 
    FORMAT( [KPI.Mkt%] , "0.0%" ) & UNICHAR( 34 )
    
    ,
    
    SELECTEDMEASUREFORMATSTRING()
    
)

```

比如下面这张图，想要查在图上显示各类别的百分比

![](https://secure2.wostatic.cn/static/iWdxMXWYJKwT8XUV2PFa51/image.png?auth_key=1655612683-qG8DzKAHr5SFQXGpVh3Cjz-0-d29425d3dec8893251d5455d989dcd2d)

基础度量如下：

```js
Sales Amount = SUM( 'Sales'[Sales Amount] )

Sales Amount % by Quarter = 
DIVIDE( [Sales Amount], CALCULATE( [Sales Amount], ALL( 'Date'[Fiscal Quarter] )))
```

采用计算组，创建计算项,格式表达式设置为如下，应用后会发现左边的轴也变了，

```js
IF (
    ISSELECTEDMEASURE( [Sales Amount] ) ,
    VAR FormattedValue = FORMAT( [Sales Amount % by Quarter], "#,0%" )
    VAR SubstitutedValue = SUBSTITUTE(FormattedValue, "0", "\O")
    RETURN SubstitutedValue,
    SELECTEDMEASUREFORMATSTRING()
)
```

![](https://secure2.wostatic.cn/static/3UvUbyBwzTZAk5Vne4FWu8/image.png?auth_key=1655612690-tb9e3QiwC2XCxxvAjsrRNB-0-7c90d71f6bcbec31e55a0fc02574c828)

将Sales Amount再拖入到行值，然后设置折线的宽度为0

![](https://secure2.wostatic.cn/static/njmnsQTBdGdNgBPCVyxchv/image.png?auth_key=1655612699-mwmSk96Wr99FNjpAAXN1mp-0-bf52bb816f1894d3c04685be07119f2c)

之后在设置下主Y轴在右侧显示，这样辅助Y轴就在左侧了

![](https://secure2.wostatic.cn/static/f1SPa2ruFP14ZTbsSjFYyT/image.png?auth_key=1655612705-bToWwuFmNmR7PnkCJkXonk-0-ecd050fd611e928c649d08b44b8a7c61)

还剩最后一步，将Sales Amount 放到工具提示上

![](https://secure2.wostatic.cn/static/jJ78xJWYccZmszTLTyM2nx/image.png?auth_key=1655612713-3gVSEFBBx969k5HojLobE5-0-4644d20944d997b48d41f8d08d400839)

## 扩展阅读

[[控制计算组中的格式表达式]]